# Курс по Git

## Конспект

### История

* Системы контроля версий первого поколения (локальные файлы)
  * SCCS
  * RCS
* Системы контроля версий второго поколения (поддержка сети, удалённый сервер)
  * CVS
  * BitKeeper
  * SVN
* Системы контроля версий третьего поколения (несколько равнозначных репозиториев)
  * Git
  * Mercurial

![history](imgs/history.png)

#### Git 

* Разработан Линусом Торвальдсом в 2005 для написания ядра Линукса группой разработчиков. 
* Самая популярная в мире система управлениями версиями.
* Git является распределённой системой. Центрального репозитория не существует: все копии создаются равными.
* Разработчики могут вносить свои изменения в локальную копию репозитория без ведома других репозиториев. Это допускает коммиты без подключения к сети или интернету.

### Настройка окружения

Прежде чем начинать работу, нужно настроить окружение:

```bash
git config --global user.name "<ваш_ник_на_гитхабе>"
git config --global user.email "<адрес_почты@gmail.com>"
```

Основные понятия в Git:

* 


### Cоздание первого проекта

Cоздадим тестовый проектик:

```bash
git init sample-project
cd sample-project
```

Посмотрим, какие файлы у нас есть:
```bash
ls -a
```

Посмотрим, текущее состояние нашего репозитория:
```bash
git status
```

`git status` -- очень полезная команда, помогает понять, что происходит во многих случаях

### Закоммитим файл

Сделаем файл `README.md`
```
echo "I'm learning Git" >> README.md
```

Посмотрим, что у нас получилось:
```
git status
```

Добавим файл в индекс:
```
git add README.md
git status
```

Сделаем коммит:
```
git commit -m "docs: add README.md"
git status
```

### Состояния файлов в Git

* untracked
* umodified
* modified
* staged

![Lifecycle](imgs/lifecycle.png)

### Добавим удалённый репозиторий

* Создадим удалённый репозиторий, используя GitHub веб-интерфейс
* Добавим удалённый репозиторий:
  ```bash
  git remote add origin https://github.com/<логин>/<имя-репы>
  ```
* Проверим, что всё успешно добавилось:
  ```bash
  git remote -v
  ```
* Запушим наши коммиты:
  ```bash
  git push
  ```
* Попробуем ещё раз
  ```bash
  git push --set-upstream origin main
  ```
* Сделаем ещё какой-нибудь коммит и запушим его:
  ```bash
  git push
  ```
  Как можно заметить, делать `git push --set-upstream origin main` не понадобилось.

### Получение новых коммитов из репозитория

* С помощью web-интерфейса изменим `README.md`
* Посмотрим на состояние репозитория до получения коммита:
  ```bash
  git log
  git status
  ```
* Получим изменения с удалённого репозитория:
  ```bash
  git pull --rebase origin 
  ```
* Посмотрим состояние репозитория сейчас:
  ```bash
  git log
  git status
  ```

### Коммиты и ветки

Коммит -- это просто снапшот репозитория в определённый момент времени. В коммите помимо (указателя на дерево файлов) также содержится:
  * HASH коммита
  * Ссылка на предыдущий коммит (или несколько ссылок)
    * Если нет родителей -- root коммит
    * Если несколько -- merge коммит
  * Автор, коммитер
  * Комментарий
  * Дата

Всё это можно подменить, но хэш изменится.


#### Ветки

TODO

### Создание веток

```bash
git branch sergey/my-branch
git checkout sergey/my-branch
```

```bash
git bas
```


```git bash
git switch -c 
```

### Интерактивчик

Давайте попробуем вместе попушить в репозиторий, посмотрим что получится :)

1. Создадим общий репозиторий:
   * Добавим файлик
   ```bash
   cat "Sergey" > name.txt
   ``` 
2. Склонируем локально:
  ```bash
  git clone https://github.com/sergeypospelov/common-repo
  ```
3. Добавьте в файлик своё имя локально, сделайте коммит и сделайте push:
   ```bash
   git commit -am "docs: add <ваше_имя>"   
   ```
   ```bash
   git push
   ```
4. Получается гонка данных, нужно делать rebase:
    ```bash
    git pull --rebase
    ```

Либо железобетонный метод:

```bash
git push -f
```
Но обычно от этого есть защита:
  * Закрыть ветку на пуш

### Merge конфликт

Возникает, когда ваши изменения 

### Best practices

Если не следовать каким-то договоренностям, то совместная разработка может превратиться в боль.

#### Linear history

В главной ветке (main или master) нужно избегать коммитов, у которых больше одного родителя! То есть главная ветка должна выглядет линейно.

Для этого, перед тем как добавлять новую функциональность, нужно склеить свои коммиты:
```
git reset --soft HEAD~3
git status
git commit
```

После этого нужно сделать.

```bash
git pull --rebase
```

После этого, нужно за

Таким образом, коммиты из удаленного репозитория накинуться на вашу ветку, и сверху них накинутся один ваш склееный коммит.

#### Feature branches

Когда разработчики работает над одной фичой, затрагивающей общую функциональность, они создают

No merge commits!

![git-flow](imgs/git_flow.png)


#### Conventional commits

Нужно правильно именовать коммиты:

- fix: a commit of the type fix patches a bug in your codebase
- feat: a commit of the type feat introduces a new feature to the codebase
- BREAKING CHANGE
- build:, chore:, ci:, docs:, style:, refactor:, perf:, test:


### Для чего можно использовать Git уже сегодня?

* Home page
* Хранение алгосиков из спортпроги
* Хранение посылок по задачам и условий задач
* Хранение CV
* Хранение pet-проджектов
* Хранение всякой инфы про учёбу

### Вторая часть курса

Плюшки GitHub:
* Pull Requests
* GitHub Actions
* Issues
* Discussions
* etc.

### Полезная информация

#### Ссылки

* https://www.conventionalcommits.org/en/v1.0.0/

#### Ещё команды
```bash
git diff
git log --graph --pretty=oneline --abbrev-commit
```

#### UI клиенты

* Git Client
* Sublime Merge
* Etc.
* Intellij Idea

#### Help

К любой команде можно добваить `--help` для вывода справки по этой команде:
```bash
git add --help
git commit --help
git checkout --help
git pull --help
```